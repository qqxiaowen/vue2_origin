{"version":3,"file":"vue.js","sources":["../src/observe/index.js","../src/state.js","../src/init.js","../src/index.js"],"sourcesContent":["export function observe(data) {\n  if (typeof data !== 'object' || data === null) {\n    return; // 只对对象（饮用数据类型）劫持\n  }\n\n  // 如果一个对象被劫持过了，那就不需要再被劫持了（可以添加一个实例，来判断是否被劫持）\n  return new Observer(data);\n}\n\nclass Observer {\n  constructor(data) {\n    this.walk(data);\n  }\n  walk(data) {\n    Object.keys(data).forEach(key => defineReactive(data, key, data[key]));\n  }\n}\n\nexport function defineReactive(target, key, value) {\n  // value属性 闭包\n  observe(value); // 对所有属性都进行劫持-递归\n  // defineProperty \"重新定义\"属性，性能差\n  Object.defineProperty(target, key, {\n    get() {\n      console.log('用户get');\n      return value;\n    },\n    set(newValue) {\n      console.log('用户set');\n      if (newValue === value) return;\n      value = newValue;\n    }\n  });\n}\n","/*\n * @Date: 2022-07-18 17:28:01\n * @LastEditors: xiaoWen\n * @LastEditTime: 2022-07-18 18:08:49\n * @FilePath: /study-vue/src/state.js\n */\n\nimport { observe } from './observe/index';\n\n// 初始化数据\nexport function initState(vm) {\n  const opts = vm.$option;\n  if (opts.data) {\n    initData(vm);\n  }\n  // if(opts.props) {\n  //   initProps(vm)\n  // }\n}\n\nfunction initData(vm) {\n  let data = vm.$option.data;\n  data = typeof data === 'function' ? data.call(vm) : data;\n  vm._data = data;\n  observe(data);\n\n  // 将vm._data 用vm来代理\n  proxy(vm, data, '_data');\n}\n\nfunction proxy(vm, target, proxyTargetName) {\n  Object.keys(target).forEach(key => {\n    Object.defineProperty(vm, key, {\n      get() {\n        return vm[proxyTargetName][key];\n      },\n      set(newValue) {\n        vm[proxyTargetName][key] = newValue\n      }\n    });\n  });\n}\n","import { initState } from \"./state\";\n\n/*\n * @Date: 2022-07-18 17:03:49\n * @LastEditors: xiaoWen\n * @LastEditTime: 2022-07-18 17:28:05\n * @FilePath: /study-vue/src/init.js\n */\nexport function initMixin(Vue) {\n  Vue.prototype._init = function (option) {\n    const vm = this;\n    vm.$option = option;\n\n    // 初始化状态\n    initState(vm)\n    // todo。。。\n  };\n}\n\n","import { initMixin } from \"./init\";\n\nfunction Vue(options) {\n  this._init(options)\n}\ninitMixin(Vue)\n\n\nexport default Vue;\n"],"names":["observe","data","Observer","walk","Object","keys","forEach","key","defineReactive","target","value","defineProperty","get","console","log","set","newValue","initState","vm","opts","$option","initData","call","_data","proxy","proxyTargetName","initMixin","Vue","prototype","_init","option","options"],"mappings":"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"}